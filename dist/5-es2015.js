(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{jkDv:function(t,e,c){"use strict";c.r(e);var n=c("ofXK"),a=c("hI8S"),s=c("YUcS"),i=c("vvyD"),o=c("tyNb"),r=c("fXoL"),l=c("8B9z");let b=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.Ib({type:t,selectors:[["app-admin-container"]],decls:2,vars:0,template:function(t,e){1&t&&(r.Pb(0,"app-nav-bar"),r.Pb(1,"router-outlet"))},directives:[l.a,o.i],styles:["","[_nghost-%COMP%]{position:absolute;top:56px;bottom:0;left:0;right:0}"]}),t})();var u=c("mCNh"),d=c("lJxs"),m=c("4MDz"),h=c("+0xr"),f=c("bUwk"),p=c("zkEj"),g=c("7dP1"),U=c("pD6V"),C=c("QfNU"),T=c("pLZG"),O=c("XqQ8"),B=c("JIr8"),D=c("EY2u"),w=c("3Pt+"),A=c("0IaG"),S=c("bSwM"),v=c("bTqV");let R=(()=>{class t{constructor(t,e,c,n){this.auth=t,this.fb=e,this.dialogRef=c,this.data=n}ngOnInit(){this.form=this.fb.group({hasRoleAdmin:new w.d(this.auth.hasRoleAdmin(this.data.roles)),hasRoleUser:new w.d(this.auth.hasRoleUser(this.data.roles)),isAccountEnabled:new w.d(this.data.enabled)})}confirm(){const t={roles:this.auth.packRoles(this.form.value.hasRoleAdmin,this.form.value.hasRoleUser),enabled:this.form.value.isAccountEnabled};this.dialogRef.close(t)}close(){this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(r.Ob(g.a),r.Ob(w.c),r.Ob(A.g),r.Ob(A.a))},t.\u0275cmp=r.Ib({type:t,selectors:[["app-user-dialog"]],decls:23,vars:2,consts:[["mat-dialog-title",""],[3,"formGroup"],["color","primary","formControlName","hasRoleAdmin"],["color","primary","formControlName","hasRoleUser"],["color","primary","formControlName","isAccountEnabled"],["align","end"],["mat-button","","color","primary",3,"click"]],template:function(t,e){1&t&&(r.Ub(0,"h2",0),r.Bc(1,"Edit account authorities"),r.Tb(),r.Ub(2,"mat-dialog-content",1),r.Ub(3,"h5"),r.Bc(4,"Account to be updated"),r.Tb(),r.Ub(5,"p"),r.Bc(6),r.Tb(),r.Ub(7,"h5"),r.Bc(8,"Granted authorities"),r.Tb(),r.Ub(9,"mat-checkbox",2),r.Bc(10,"admin"),r.Tb(),r.Pb(11,"br"),r.Ub(12,"mat-checkbox",3),r.Bc(13,"user"),r.Tb(),r.Ub(14,"h5"),r.Bc(15,"Account status"),r.Tb(),r.Ub(16,"mat-checkbox",4),r.Bc(17,"enabled"),r.Tb(),r.Tb(),r.Ub(18,"mat-dialog-actions",5),r.Ub(19,"button",6),r.cc("click",(function(t){return e.close()})),r.Bc(20,"Cancel"),r.Tb(),r.Ub(21,"button",6),r.cc("click",(function(t){return e.confirm()})),r.Bc(22,"Update"),r.Tb(),r.Tb()),2&t&&(r.Cb(2),r.nc("formGroup",e.form),r.Cb(4),r.Cc(e.data.email))},directives:[A.h,A.e,w.m,w.g,S.a,w.l,w.e,A.d,v.b],styles:[".mat-dialog-content[_ngcontent-%COMP%]{overflow:unset}"]}),t})();var y=c("Rn6e"),k=c("STbY"),j=c("NFeN");let M=(()=>{class t{constructor(t,e,c){this.dialog=t,this.snackBar=e,this.http=c,this.userDeleted=new r.o,this.userUpdated=new r.o}ngOnInit(){}openDeleteDialog(){this.dialog.open(y.a,{data:{title:"Delete account?",message:`Account [${this.user.email}] will be deleted`,cancelButton:"Cancel",confirmButton:"Delete"},autoFocus:!1}).afterClosed().pipe(Object(T.a)(t=>!0===t),Object(O.a)(()=>this.http.deleteUser(this.user.userId)),Object(d.a)(()=>this.userDeleted.emit()),Object(B.a)(t=>(this.snackBar.openError(Object(m.b)(t,"Failed to fetch users")),D.a))).subscribe()}openEditDialog(){this.dialog.open(R,{data:{email:this.user.email,roles:this.user.roles,enabled:this.user.enabled}}).afterClosed().pipe(Object(T.a)(t=>void 0!==t),Object(O.a)(t=>this.http.updateUser(this.user.userId,{roles:t.roles,enabled:t.enabled})),Object(d.a)(t=>this.userUpdated.emit(t)),Object(B.a)(t=>(this.snackBar.openError(Object(m.b)(t,"Failed to update user")),D.a))).subscribe()}}return t.\u0275fac=function(e){return new(e||t)(r.Ob(A.c),r.Ob(p.a),r.Ob(f.a))},t.\u0275cmp=r.Ib({type:t,selectors:[["app-user-operations-menu"]],inputs:{user:"user"},outputs:{userDeleted:"userDeleted",userUpdated:"userUpdated"},decls:15,vars:1,consts:[["mat-icon-button","",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["color","primary"],["color","warn"]],template:function(t,e){if(1&t&&(r.Ub(0,"button",0),r.Ub(1,"mat-icon"),r.Bc(2,"more_vert"),r.Tb(),r.Tb(),r.Ub(3,"mat-menu",null,1),r.Ub(5,"button",2),r.cc("click",(function(t){return e.openEditDialog()})),r.Ub(6,"mat-icon",3),r.Bc(7,"edit"),r.Tb(),r.Ub(8,"span"),r.Bc(9,"Edit"),r.Tb(),r.Tb(),r.Ub(10,"button",2),r.cc("click",(function(t){return e.openDeleteDialog()})),r.Ub(11,"mat-icon",4),r.Bc(12,"clear"),r.Tb(),r.Ub(13,"span"),r.Bc(14,"Delete"),r.Tb(),r.Tb(),r.Tb()),2&t){const t=r.sc(4);r.nc("matMenuTriggerFor",t)}},directives:[v.b,k.c,j.a,k.d,k.a],styles:[""]}),t})();var I=c("VNUq"),P=c("dWs1");function E(t,e){if(1&t&&r.Pb(0,"app-error-message",2),2&t){const t=r.gc();r.nc("message",t.fetchErrorMessage)}}function F(t,e){1&t&&r.Pb(0,"th",17)}function x(t,e){if(1&t&&(r.Ub(0,"td",18),r.Bc(1),r.Tb()),2&t){const t=e.index;r.Cb(1),r.Cc(t+1)}}function N(t,e){1&t&&(r.Ub(0,"th",17),r.Bc(1,"Public Id"),r.Tb())}function $(t,e){if(1&t&&(r.Ub(0,"td",18),r.Bc(1),r.Tb()),2&t){const t=e.$implicit;r.Cb(1),r.Cc(t.userId)}}function _(t,e){1&t&&(r.Ub(0,"th",17),r.Bc(1,"Name"),r.Tb())}const q=function(t,e){return[t,e]};function G(t,e){if(1&t&&(r.Ub(0,"td",18),r.Bc(1),r.Tb()),2&t){const t=e.$implicit;r.Cb(1),r.Cc(r.qc(1,q,t.firstName,t.lastName).join(" "))}}function L(t,e){1&t&&(r.Ub(0,"th",17),r.Bc(1,"Email"),r.Tb())}function z(t,e){if(1&t&&(r.Ub(0,"td",18),r.Bc(1),r.Tb()),2&t){const t=e.$implicit;r.Cb(1),r.Cc(t.email)}}function J(t,e){1&t&&(r.Ub(0,"th",17),r.Bc(1,"Roles"),r.Tb())}function V(t,e){if(1&t&&(r.Ub(0,"td",18),r.Bc(1),r.Tb()),2&t){const t=e.$implicit,c=r.gc(2);r.Cb(1),r.Cc(c.rolesToString(t.roles))}}function H(t,e){1&t&&(r.Ub(0,"th",17),r.Bc(1,"Created"),r.Tb())}function X(t,e){if(1&t&&(r.Ub(0,"td",18),r.Bc(1),r.hc(2,"dateTimeFormat"),r.Tb()),2&t){const t=e.$implicit;r.Cb(1),r.Cc(r.ic(2,1,t.createdOn))}}function Y(t,e){1&t&&(r.Ub(0,"th",17),r.Bc(1,"Last Seen"),r.Tb())}function Q(t,e){if(1&t&&(r.Ub(0,"td",18),r.Bc(1),r.hc(2,"fromNow"),r.Tb()),2&t){const t=e.$implicit;r.Cb(1),r.Cc(r.jc(2,1,t.lastSeenOn," ago"))}}function K(t,e){1&t&&(r.Ub(0,"th",17),r.Bc(1,"Status"),r.Tb())}function W(t,e){if(1&t&&(r.Ub(0,"td",18),r.Bc(1),r.Tb()),2&t){const t=e.$implicit;r.Cb(1),r.Cc(t.enabled?"enabled":"blocked")}}function Z(t,e){1&t&&r.Pb(0,"th",17)}function tt(t,e){if(1&t){const t=r.Vb();r.Ub(0,"td",18),r.Ub(1,"app-user-operations-menu",19),r.cc("userUpdated",(function(c){r.uc(t);const n=e.$implicit;return r.gc(2).updateUser(n,c)}))("userDeleted",(function(c){r.uc(t);const n=e.$implicit;return r.gc(2).deleteUser(n)})),r.Tb(),r.Tb()}if(2&t){const t=e.$implicit;r.Cb(1),r.nc("user",t)}}function et(t,e){1&t&&r.Pb(0,"tr",20)}function ct(t,e){1&t&&r.Pb(0,"tr",21)}function nt(t,e){if(1&t&&(r.Ub(0,"table",3),r.Sb(1,4),r.Ac(2,F,1,0,"th",5),r.Ac(3,x,2,1,"td",6),r.Rb(),r.Sb(4,7),r.Ac(5,N,2,0,"th",5),r.Ac(6,$,2,1,"td",6),r.Rb(),r.Sb(7,8),r.Ac(8,_,2,0,"th",5),r.Ac(9,G,2,4,"td",6),r.Rb(),r.Sb(10,9),r.Ac(11,L,2,0,"th",5),r.Ac(12,z,2,1,"td",6),r.Rb(),r.Sb(13,10),r.Ac(14,J,2,0,"th",5),r.Ac(15,V,2,1,"td",6),r.Rb(),r.Sb(16,11),r.Ac(17,H,2,0,"th",5),r.Ac(18,X,3,3,"td",6),r.Rb(),r.Sb(19,12),r.Ac(20,Y,2,0,"th",5),r.Ac(21,Q,3,4,"td",6),r.Rb(),r.Sb(22,13),r.Ac(23,K,2,0,"th",5),r.Ac(24,W,2,1,"td",6),r.Rb(),r.Sb(25,14),r.Ac(26,Z,1,0,"th",5),r.Ac(27,tt,2,1,"td",6),r.Rb(),r.Ac(28,et,1,0,"tr",15),r.Ac(29,ct,1,0,"tr",16),r.Tb()),2&t){const t=r.gc();r.nc("dataSource",t.dataSource),r.Cb(28),r.nc("matHeaderRowDef",t.displayedColumns),r.Cb(1),r.nc("matRowDefColumns",t.displayedColumns)}}const at=[{path:"",component:b,children:[{path:"users",pathMatch:"full",component:(()=>{class t{constructor(t,e,c,n){var a;this.http=t,this.snackBar=e,this.auth=c,this.mediaObserver=n,this.dataSource=null,this.isFetchUsersFailed=!1,this.fetchErrorMessage="",this.displayedColumns=["index","id","mail","name","created","seen","roles","status","menu"],this.columnsConfig=function(t,e,c,n){const a=(t,e)=>(e.forEach(e=>t=t.filter(t=>t!==e)),t),s=t.slice(),i=a(s.slice(),["id"]),o=a(i.slice(),["created","seen"]),r=a(o.slice(),["name"]);return{def:s,md:i,sm:o,xs:r}}(this.displayedColumns),this.mediaObserver.filterOverlaps=!0,this.mediaSub=n.asObservable().pipe((a=this.columnsConfig,Object(u.a)(Object(d.a)(t=>t[t.length-1].mqAlias),Object(d.a)(t=>a[a[t]?t:"def"])))).subscribe(t=>this.displayedColumns=t)}ngOnInit(){this.fetchUsers()}ngOnDestroy(){this.mediaSub.unsubscribe()}fetchUsers(){this.http.getAllUsers().subscribe(t=>{this.dataSource=new h.k(t),this.isFetchUsersFailed=!1},t=>{this.fetchErrorMessage=Object(m.b)(t,"Failed to fetch users"),this.snackBar.openError(this.fetchErrorMessage),this.dataSource=null,this.isFetchUsersFailed=!0})}deleteUser(t){const e=this.dataSource.data;e.splice(e.indexOf(t),1),this.dataSource._updateChangeSubscription()}updateUser(t,e){const c=this.dataSource.data;c[c.indexOf(t)]=e,this.dataSource._updateChangeSubscription()}rolesToString(t){return this.auth.rolesToString(t)}}return t.\u0275fac=function(e){return new(e||t)(r.Ob(f.a),r.Ob(p.a),r.Ob(g.a),r.Ob(U.g))},t.\u0275cmp=r.Ib({type:t,selectors:[["app-users-list"]],decls:2,vars:2,consts:[[3,"message",4,"ngIf"],["mat-table","",3,"dataSource",4,"ngIf"],[3,"message"],["mat-table","",3,"dataSource"],["matColumnDef","index"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","id"],["matColumnDef","name"],["matColumnDef","mail"],["matColumnDef","roles"],["matColumnDef","created"],["matColumnDef","seen"],["matColumnDef","status"],["matColumnDef","menu"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"user","userUpdated","userDeleted"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(r.Ac(0,E,1,1,"app-error-message",0),r.Ac(1,nt,30,3,"table",1)),2&t&&(r.nc("ngIf",e.isFetchUsersFailed),r.Cb(1),r.nc("ngIf",null!==e.dataSource&&!e.isFetchUsersFailed))},directives:[n.l,C.a,h.j,h.c,h.e,h.b,h.g,h.i,h.d,h.a,M,h.f,h.h],pipes:[I.a,P.a],styles:["table[_ngcontent-%COMP%]{width:100%}th[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:rgba(0,0,0,.7)}.mat-row[_ngcontent-%COMP%]{height:auto}.mat-cell[_ngcontent-%COMP%]{padding:8px 8px 8px 0}td.mat-cell[_ngcontent-%COMP%]:last-of-type{padding-right:0}"]}),t})()},{path:"",pathMatch:"full",redirectTo:"users"}]}];let st=(()=>{class t{}return t.\u0275mod=r.Mb({type:t}),t.\u0275inj=r.Lb({factory:function(e){return new(e||t)},imports:[[o.h.forChild(at)],o.h]}),t})();var it=c("DPoA"),ot=c("hID/");c.d(e,"AdminModule",(function(){return rt}));let rt=(()=>{class t{}return t.\u0275mod=r.Mb({type:t}),t.\u0275inj=r.Lb({factory:function(e){return new(e||t)},imports:[[ot.a,w.p,it.a,a.a,n.c,s.a,i.a,st]]}),t})()}}]);
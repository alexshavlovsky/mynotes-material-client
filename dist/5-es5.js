function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{jkDv:function(e,t,n){"use strict";n.r(t);var a,c,i,r=n("ofXK"),o=n("hI8S"),s=n("YUcS"),u=n("vvyD"),l=n("tyNb"),b=n("fXoL"),d=n("8B9z"),f=((a=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||a)},a.\u0275cmp=b.Ib({type:a,selectors:[["app-admin-container"]],decls:2,vars:0,template:function(e,t){1&e&&(b.Pb(0,"app-nav-bar"),b.Pb(1,"router-outlet"))},directives:[d.a,l.i],styles:["","[_nghost-%COMP%]{position:absolute;top:56px;bottom:0;left:0;right:0}"]}),a),h=n("mCNh"),m=n("lJxs"),p=n("4MDz"),C=n("+0xr"),g=n("bUwk"),U=n("zkEj"),v=n("7dP1"),T=n("pD6V"),O=n("QfNU"),k=n("pLZG"),y=n("XqQ8"),w=n("JIr8"),B=n("EY2u"),D=n("3Pt+"),A=n("0IaG"),S=n("bSwM"),R=n("bTqV"),_=((c=function(){function e(t,n,a,c){_classCallCheck(this,e),this.auth=t,this.fb=n,this.dialogRef=a,this.data=c}return _createClass(e,[{key:"ngOnInit",value:function(){this.form=this.fb.group({hasRoleAdmin:new D.d(this.auth.hasRoleAdmin(this.data.roles)),hasRoleUser:new D.d(this.auth.hasRoleUser(this.data.roles)),isAccountEnabled:new D.d(this.data.enabled)})}},{key:"confirm",value:function(){var e={roles:this.auth.packRoles(this.form.value.hasRoleAdmin,this.form.value.hasRoleUser),enabled:this.form.value.isAccountEnabled};this.dialogRef.close(e)}},{key:"close",value:function(){this.dialogRef.close()}}]),e}()).\u0275fac=function(e){return new(e||c)(b.Ob(v.a),b.Ob(D.c),b.Ob(A.g),b.Ob(A.a))},c.\u0275cmp=b.Ib({type:c,selectors:[["app-user-dialog"]],decls:23,vars:2,consts:[["mat-dialog-title",""],[3,"formGroup"],["color","primary","formControlName","hasRoleAdmin"],["color","primary","formControlName","hasRoleUser"],["color","primary","formControlName","isAccountEnabled"],["align","end"],["mat-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(b.Ub(0,"h2",0),b.Bc(1,"Edit account authorities"),b.Tb(),b.Ub(2,"mat-dialog-content",1),b.Ub(3,"h5"),b.Bc(4,"Account to be updated"),b.Tb(),b.Ub(5,"p"),b.Bc(6),b.Tb(),b.Ub(7,"h5"),b.Bc(8,"Granted authorities"),b.Tb(),b.Ub(9,"mat-checkbox",2),b.Bc(10,"admin"),b.Tb(),b.Pb(11,"br"),b.Ub(12,"mat-checkbox",3),b.Bc(13,"user"),b.Tb(),b.Ub(14,"h5"),b.Bc(15,"Account status"),b.Tb(),b.Ub(16,"mat-checkbox",4),b.Bc(17,"enabled"),b.Tb(),b.Tb(),b.Ub(18,"mat-dialog-actions",5),b.Ub(19,"button",6),b.cc("click",(function(e){return t.close()})),b.Bc(20,"Cancel"),b.Tb(),b.Ub(21,"button",6),b.cc("click",(function(e){return t.confirm()})),b.Bc(22,"Update"),b.Tb(),b.Tb()),2&e&&(b.Cb(2),b.nc("formGroup",t.form),b.Cb(4),b.Cc(t.data.email))},directives:[A.h,A.e,D.m,D.g,S.a,D.l,D.e,A.d,R.b],styles:[".mat-dialog-content[_ngcontent-%COMP%]{overflow:unset}"]}),c),P=n("Rn6e"),j=n("STbY"),M=n("NFeN"),I=((i=function(){function e(t,n,a){_classCallCheck(this,e),this.dialog=t,this.snackBar=n,this.http=a,this.userDeleted=new b.o,this.userUpdated=new b.o}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"openDeleteDialog",value:function(){var e=this;this.dialog.open(P.a,{data:{title:"Delete account?",message:"Account [".concat(this.user.email,"] will be deleted"),cancelButton:"Cancel",confirmButton:"Delete"},autoFocus:!1}).afterClosed().pipe(Object(k.a)((function(e){return!0===e})),Object(y.a)((function(){return e.http.deleteUser(e.user.userId)})),Object(m.a)((function(){return e.userDeleted.emit()})),Object(w.a)((function(t){return e.snackBar.openError(Object(p.b)(t,"Failed to fetch users")),B.a}))).subscribe()}},{key:"openEditDialog",value:function(){var e=this;this.dialog.open(_,{data:{email:this.user.email,roles:this.user.roles,enabled:this.user.enabled}}).afterClosed().pipe(Object(k.a)((function(e){return void 0!==e})),Object(y.a)((function(t){return e.http.updateUser(e.user.userId,{roles:t.roles,enabled:t.enabled})})),Object(m.a)((function(t){return e.userUpdated.emit(t)})),Object(w.a)((function(t){return e.snackBar.openError(Object(p.b)(t,"Failed to update user")),B.a}))).subscribe()}}]),e}()).\u0275fac=function(e){return new(e||i)(b.Ob(A.c),b.Ob(U.a),b.Ob(g.a))},i.\u0275cmp=b.Ib({type:i,selectors:[["app-user-operations-menu"]],inputs:{user:"user"},outputs:{userDeleted:"userDeleted",userUpdated:"userUpdated"},decls:15,vars:1,consts:[["mat-icon-button","",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["color","primary"],["color","warn"]],template:function(e,t){if(1&e&&(b.Ub(0,"button",0),b.Ub(1,"mat-icon"),b.Bc(2,"more_vert"),b.Tb(),b.Tb(),b.Ub(3,"mat-menu",null,1),b.Ub(5,"button",2),b.cc("click",(function(e){return t.openEditDialog()})),b.Ub(6,"mat-icon",3),b.Bc(7,"edit"),b.Tb(),b.Ub(8,"span"),b.Bc(9,"Edit"),b.Tb(),b.Tb(),b.Ub(10,"button",2),b.cc("click",(function(e){return t.openDeleteDialog()})),b.Ub(11,"mat-icon",4),b.Bc(12,"clear"),b.Tb(),b.Ub(13,"span"),b.Bc(14,"Delete"),b.Tb(),b.Tb(),b.Tb()),2&e){var n=b.sc(4);b.nc("matMenuTriggerFor",n)}},directives:[R.b,j.c,M.a,j.d,j.a],styles:[""]}),i),E=n("VNUq"),F=n("dWs1");function x(e,t){if(1&e&&b.Pb(0,"app-error-message",2),2&e){var n=b.gc();b.nc("message",n.fetchErrorMessage)}}function N(e,t){1&e&&b.Pb(0,"th",17)}function $(e,t){if(1&e&&(b.Ub(0,"td",18),b.Bc(1),b.Tb()),2&e){var n=t.index;b.Cb(1),b.Cc(n+1)}}function q(e,t){1&e&&(b.Ub(0,"th",17),b.Bc(1,"Public Id"),b.Tb())}function G(e,t){if(1&e&&(b.Ub(0,"td",18),b.Bc(1),b.Tb()),2&e){var n=t.$implicit;b.Cb(1),b.Cc(n.userId)}}function L(e,t){1&e&&(b.Ub(0,"th",17),b.Bc(1,"Name"),b.Tb())}var z=function(e,t){return[e,t]};function J(e,t){if(1&e&&(b.Ub(0,"td",18),b.Bc(1),b.Tb()),2&e){var n=t.$implicit;b.Cb(1),b.Cc(b.qc(1,z,n.firstName,n.lastName).join(" "))}}function V(e,t){1&e&&(b.Ub(0,"th",17),b.Bc(1,"Email"),b.Tb())}function H(e,t){if(1&e&&(b.Ub(0,"td",18),b.Bc(1),b.Tb()),2&e){var n=t.$implicit;b.Cb(1),b.Cc(n.email)}}function X(e,t){1&e&&(b.Ub(0,"th",17),b.Bc(1,"Roles"),b.Tb())}function Y(e,t){if(1&e&&(b.Ub(0,"td",18),b.Bc(1),b.Tb()),2&e){var n=t.$implicit,a=b.gc(2);b.Cb(1),b.Cc(a.rolesToString(n.roles))}}function Q(e,t){1&e&&(b.Ub(0,"th",17),b.Bc(1,"Created"),b.Tb())}function K(e,t){if(1&e&&(b.Ub(0,"td",18),b.Bc(1),b.hc(2,"dateTimeFormat"),b.Tb()),2&e){var n=t.$implicit;b.Cb(1),b.Cc(b.ic(2,1,n.createdOn))}}function W(e,t){1&e&&(b.Ub(0,"th",17),b.Bc(1,"Last Seen"),b.Tb())}function Z(e,t){if(1&e&&(b.Ub(0,"td",18),b.Bc(1),b.hc(2,"fromNow"),b.Tb()),2&e){var n=t.$implicit;b.Cb(1),b.Cc(b.jc(2,1,n.lastSeenOn," ago"))}}function ee(e,t){1&e&&(b.Ub(0,"th",17),b.Bc(1,"Status"),b.Tb())}function te(e,t){if(1&e&&(b.Ub(0,"td",18),b.Bc(1),b.Tb()),2&e){var n=t.$implicit;b.Cb(1),b.Cc(n.enabled?"enabled":"blocked")}}function ne(e,t){1&e&&b.Pb(0,"th",17)}function ae(e,t){if(1&e){var n=b.Vb();b.Ub(0,"td",18),b.Ub(1,"app-user-operations-menu",19),b.cc("userUpdated",(function(e){b.uc(n);var a=t.$implicit;return b.gc(2).updateUser(a,e)}))("userDeleted",(function(e){b.uc(n);var a=t.$implicit;return b.gc(2).deleteUser(a)})),b.Tb(),b.Tb()}if(2&e){var a=t.$implicit;b.Cb(1),b.nc("user",a)}}function ce(e,t){1&e&&b.Pb(0,"tr",20)}function ie(e,t){1&e&&b.Pb(0,"tr",21)}function re(e,t){if(1&e&&(b.Ub(0,"table",3),b.Sb(1,4),b.Ac(2,N,1,0,"th",5),b.Ac(3,$,2,1,"td",6),b.Rb(),b.Sb(4,7),b.Ac(5,q,2,0,"th",5),b.Ac(6,G,2,1,"td",6),b.Rb(),b.Sb(7,8),b.Ac(8,L,2,0,"th",5),b.Ac(9,J,2,4,"td",6),b.Rb(),b.Sb(10,9),b.Ac(11,V,2,0,"th",5),b.Ac(12,H,2,1,"td",6),b.Rb(),b.Sb(13,10),b.Ac(14,X,2,0,"th",5),b.Ac(15,Y,2,1,"td",6),b.Rb(),b.Sb(16,11),b.Ac(17,Q,2,0,"th",5),b.Ac(18,K,3,3,"td",6),b.Rb(),b.Sb(19,12),b.Ac(20,W,2,0,"th",5),b.Ac(21,Z,3,4,"td",6),b.Rb(),b.Sb(22,13),b.Ac(23,ee,2,0,"th",5),b.Ac(24,te,2,1,"td",6),b.Rb(),b.Sb(25,14),b.Ac(26,ne,1,0,"th",5),b.Ac(27,ae,2,1,"td",6),b.Rb(),b.Ac(28,ce,1,0,"tr",15),b.Ac(29,ie,1,0,"tr",16),b.Tb()),2&e){var n=b.gc();b.nc("dataSource",n.dataSource),b.Cb(28),b.nc("matHeaderRowDef",n.displayedColumns),b.Cb(1),b.nc("matRowDefColumns",n.displayedColumns)}}var oe,se,ue=[{path:"",component:f,children:[{path:"users",pathMatch:"full",component:(oe=function(){function e(t,n,a,c){var i,r,o,s,u,l,b,d=this;_classCallCheck(this,e),this.http=t,this.snackBar=n,this.auth=a,this.mediaObserver=c,this.dataSource=null,this.isFetchUsersFailed=!1,this.fetchErrorMessage="",this.displayedColumns=["index","id","mail","name","created","seen","roles","status","menu"],this.columnsConfig=(r=this.displayedColumns,o=function(e,t){return t.forEach((function(t){return e=e.filter((function(e){return e!==t}))})),e},s=r.slice(),u=o(s.slice(),["id"]),l=o(u.slice(),["created","seen"]),b=o(l.slice(),["name"]),{def:s,md:u,sm:l,xs:b}),this.mediaObserver.filterOverlaps=!0,this.mediaSub=c.asObservable().pipe((i=this.columnsConfig,Object(h.a)(Object(m.a)((function(e){return e[e.length-1].mqAlias})),Object(m.a)((function(e){return i[i[e]?e:"def"]}))))).subscribe((function(e){return d.displayedColumns=e}))}return _createClass(e,[{key:"ngOnInit",value:function(){this.fetchUsers()}},{key:"ngOnDestroy",value:function(){this.mediaSub.unsubscribe()}},{key:"fetchUsers",value:function(){var e=this;this.http.getAllUsers().subscribe((function(t){e.dataSource=new C.k(t),e.isFetchUsersFailed=!1}),(function(t){e.fetchErrorMessage=Object(p.b)(t,"Failed to fetch users"),e.snackBar.openError(e.fetchErrorMessage),e.dataSource=null,e.isFetchUsersFailed=!0}))}},{key:"deleteUser",value:function(e){var t=this.dataSource.data;t.splice(t.indexOf(e),1),this.dataSource._updateChangeSubscription()}},{key:"updateUser",value:function(e,t){var n=this.dataSource.data;n[n.indexOf(e)]=t,this.dataSource._updateChangeSubscription()}},{key:"rolesToString",value:function(e){return this.auth.rolesToString(e)}}]),e}(),oe.\u0275fac=function(e){return new(e||oe)(b.Ob(g.a),b.Ob(U.a),b.Ob(v.a),b.Ob(T.g))},oe.\u0275cmp=b.Ib({type:oe,selectors:[["app-users-list"]],decls:2,vars:2,consts:[[3,"message",4,"ngIf"],["mat-table","",3,"dataSource",4,"ngIf"],[3,"message"],["mat-table","",3,"dataSource"],["matColumnDef","index"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","id"],["matColumnDef","name"],["matColumnDef","mail"],["matColumnDef","roles"],["matColumnDef","created"],["matColumnDef","seen"],["matColumnDef","status"],["matColumnDef","menu"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"user","userUpdated","userDeleted"],["mat-header-row",""],["mat-row",""]],template:function(e,t){1&e&&(b.Ac(0,x,1,1,"app-error-message",0),b.Ac(1,re,30,3,"table",1)),2&e&&(b.nc("ngIf",t.isFetchUsersFailed),b.Cb(1),b.nc("ngIf",null!==t.dataSource&&!t.isFetchUsersFailed))},directives:[r.l,O.a,C.j,C.c,C.e,C.b,C.g,C.i,C.d,C.a,I,C.f,C.h],pipes:[E.a,F.a],styles:["table[_ngcontent-%COMP%]{width:100%}th[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:rgba(0,0,0,.7)}.mat-row[_ngcontent-%COMP%]{height:auto}.mat-cell[_ngcontent-%COMP%]{padding:8px 8px 8px 0}td.mat-cell[_ngcontent-%COMP%]:last-of-type{padding-right:0}"]}),oe)},{path:"",pathMatch:"full",redirectTo:"users"}]}],le=((se=function e(){_classCallCheck(this,e)}).\u0275mod=b.Mb({type:se}),se.\u0275inj=b.Lb({factory:function(e){return new(e||se)},imports:[[l.h.forChild(ue)],l.h]}),se),be=n("DPoA"),de=n("hID/");n.d(t,"AdminModule",(function(){return he}));var fe,he=((fe=function e(){_classCallCheck(this,e)}).\u0275mod=b.Mb({type:fe}),fe.\u0275inj=b.Lb({factory:function(e){return new(e||fe)},imports:[[de.a,D.p,be.a,o.a,r.c,s.a,u.a,le]]}),fe)}}]);